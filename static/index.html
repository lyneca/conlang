<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dalgarian Translator</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
    <script>
        function toggle() {
            let input = document.getElementById('input');
            let preview = document.getElementById('preview');
            if (input.classList.contains("hidden")) {
                input.classList.remove("hidden");
                preview.classList.remove("hidden");
            } else {
                input.classList.add("hidden");
                preview.classList.add("hidden");
            }

        }
        function random() {
            fetch("/random").then(data => data.json()).then(data => {
                let elem = document.getElementById('input');
                elem.value = data.data;
                update(elem);
            });
        }
        function process(text) {
            return (" " + text.toLowerCase() + " ")
                .replace(/x/g, 'ks')
                .replace(/sh/g, 'x')
                .replace(/ c[aeiou]/g, value => ' k' + value[2])
                .replace(/ck/g, 'k')
                .replace(/a /g, '` ')
                .replace(/[^\\]'/g, value => value[0])
                .replace(/ch/g, 'c')
                .replace(/[,.] /g, value => value[0])
                .replace(/ook/g, 'u"k')
                .replace(/ooth/g, 'u"th')
                .replace(/ere[ .,]/g, value => "er " + value[3])
                .replace(/ge[ .,]/g, value => "j" + value[2])
                .replace(/pp/, 'p')
                .replace(/i[sndtz]e[ .,]/g, value => `i"${value[1]} `)
                .replace(/a[sndtz]e[ .,]/g, value => `ay${value[1]} `)
                .replace(/e[sndtz]e[ .,]/g, value => `e"${value[1]} `)
                .replace(/i[aeo]n[ .,]/g, value => `e"${value[1]}n${value[3]} `)
                .replace(/kes[ ,.]/g, value => 'ks' + value[3])
                .replace(/ked[ ,.]/g, value => 'kd' + value[3])
                .replace(/[^ ]one[ ,.]/g, value => value[0] + 'own ')
                .replace(/ved[ ,.]/g, value => 'vd' + value[3])
                .replace(/ll/g, 'l')
                .replace(/are[ ,.]/g, value => 'a"' + value[3])
                .replace(/qu/g, 'kw')
                .replace(/ui/g, value => 'u"')
                .replace(/[aeiou"]ce[ ,.]/g, value => value[0] + 's ' + value[3])
                .replace(/[aeiou]ce[ ,.]/g, value => value[0] + 'ys ' + value[3])
                .replace(/[^aeiou ]y[ ,.]/g, value => value[0] + 'e" ' + value[2])
                .replace(/[^aeiou ]y[^aeiou ]/g, value => value[0] + 'i"' + value[2])
                .replace(/the[ ,.]/g, value => 'q` ' + value[3])
                .replace(/to[ ,.]/g, value => 'tu" ' + value[2])
                .replace(/th/g, 'q')
                .replace(/ou[ntrd]/g, value => 'ow' + value[2])
                .replace(/ea/g, 'e"')
                .replace(/[ou]e/g, 'u"')
                .replace(/([aeiou`])\1/g, value => value[0] + '"')
                .replace(/([aeiou`])[ ,.]/g, value => value[0] + "' ")
                .replace(/[aeiou`][aeiou`]/g, value => value[0] + "'" + value[1])
                .trim();
        }

        function update(elem) {
            let output = process(elem.value);
            document.getElementById("output").innerText = output;
            document.getElementById("preview").innerText = output;
        }
    </script>
    <main>
        <h1>Translate English to Dalgarian</h1>
        <h2 class="dalg">translayt inglix tu" dalgare"an</h1>
        <button onclick="random()">Random Wiki Article</button>
        <button onclick="toggle()">Toggle English</button>
        <h4>Input Text</h4>
        <textarea type="text" name="input" id="input" onkeyup="update(this)"></textarea>
        <h4>Dalgarian Text</h4>
        <p class="dalg" id="output"></p>
        <h4>Internal representation</h4>
        <p id="preview"></p>
    </main>
    <script>
        update(document.getElementById('input'))
    </script>
</body>
</html>